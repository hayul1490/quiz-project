// js/quiz.js ìƒë‹¨
const QUIZ_TOTAL_COUNT = 20; // ğŸ“ ì´ ë¬¸ì œ ìˆ˜
let currentAudio = null; // ğŸ“ í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì˜¤ë””ì˜¤ ê°ì²´ë¥¼ ì €ì¥í•  ë³€ìˆ˜
// const YOUTUBE_VIDEO_ID_2 = "2xxNtPi_-Sw"; // ğŸ“ ì´ ì¤„ì„ ì œê±°í•˜ì„¸ìš”. (main.jsì—ì„œë§Œ ì •ì˜)
const LS_USER_NAME = 'quizUserName'; 
const LS_START_TIME = 'quizStartTime';

const quizData = [
    {
        q: "ì²« ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'êµµì€ ë‚˜ë­‡ê°€ì§€ê°€ ì„œë¡œ ë¶€ë”ªíˆëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°€ì¥ ì ì ˆí•œ ìƒí™©ì€ ë¬´ì—‡ì¼ê¹Œìš”?",
        sound: "q1.mp3", // ğŸ“ ì—¬ê¸°ì— ì‹¤ì œ q1.mp3 íŒŒì¼ì„ ë„£ì–´ì•¼ í•©ë‹ˆë‹¤.
        options: ["êµµì€ ë‚˜ë­‡ê°€ì§€ ì¶©ëŒìŒ", "ì”ê°€ì§€ê°€ ë°”ëŒì— í”ë“¤ë¦¬ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ë¥¼ í†±ìœ¼ë¡œ ìë¥´ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ í†µì„ ì†ë°”ë‹¥ìœ¼ë¡œ ì¹˜ëŠ” ì†Œë¦¬"],
        answerIndex: 0 
    },
    {
        q: "ë‘ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë¬´ ê¸ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ê°€ ë‚˜ëŠ” ìƒí™©ì€?",
        sound: "q2.mp3",
        options: ["ì†í†±ìœ¼ë¡œ ë‚˜ë¬´í†µì„ ë‘ë“œë¦¬ëŠ” ì†Œë¦¬", "ê¸ˆì†ìœ¼ë¡œ ë‚˜ë¬´ í‘œë©´ì„ ê¸ëŠ” ì†Œë¦¬", "ë‚˜ë¬´íŒìê°€ ë¬¼ì— ëœ¨ëŠ” ì†Œë¦¬", "ë‚˜ë­‡ê°€ì§€ë¡œ ëŒì„ ê¸ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ì„¸ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë¬´ ì†í†±ìœ¼ë¡œ ì¹˜ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ë¥¼ ì˜ ë¬˜ì‚¬í•œ ê²ƒì€?",
        sound: "q3.mp3",
        options: ["ë‚˜ë¬´ë¥¼ ì—°í•„ë¡œ í†¡í†¡ ë‘ë“œë¦¬ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ì— ì†í†±ì„ ëŒ€ê³  íŠ•ê¸°ëŠ” ì†Œë¦¬", "ëŒë©©ì´ë¡œ ë‚˜ë¬´ë¥¼ ì„¸ê²Œ ë•Œë¦¬ëŠ” ì†Œë¦¬", "ë‹¨ë‹¨í•œ ë‚˜ë¬´ê°€ ë¶€ëŸ¬ì§€ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ë„¤ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë¬´ë¿Œë¦¬ ë°ŸëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì–´ë–¤ ì†Œë¦¬ì™€ ê°€ì¥ ìœ ì‚¬í• ê¹Œìš”?",
        sound: "q4.mp3",
        options: ["ë‚™ì—½ ìœ„ë¥¼ ê±·ëŠ” ì†Œë¦¬", "ë§ˆë¥¸ ë•… ìœ„ë¥¼ ê±·ëŠ” ì†Œë¦¬", "í™ì´ ì„ì¸ ë‹¨ë‹¨í•œ ë‚˜ë¬´ë¿Œë¦¬ë¥¼ ë°ŸëŠ” ì†Œë¦¬", "ìê°ˆë°­ì„ ìë™ì°¨ê°€ ì§€ë‚˜ê°€ëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    },
    {
        q: "ë‹¤ì„¯ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ê°€ì§€ ë¶€ëŸ¬íŠ¸ë¦¬ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ì˜ íŠ¹ì§•ì€?",
        sound: "q5.mp3",
        options: ["ë•… ì†ì—ì„œ í’€ì´ ì†Ÿì•„ë‚˜ëŠ” ì†Œë¦¬", "ì‘ì€ ë§‰ëŒ€ê°€ 'ë˜‘' í•˜ê³  ë¶€ëŸ¬ì§€ëŠ” ì†Œë¦¬", "ì‹œëƒ‡ë¬¼ì´ ì¡¸ì¡¸ íë¥´ëŠ” ì†Œë¦¬", "êµµì€ ë‚˜ë¬´ê°€ ë„˜ì–´ì§€ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ì—¬ì„¯ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ê°€ì§€ê°€ ë’¤ì—‰ì¼œ í”ë“¤ë¦¬ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì–´ë–¤ ìƒí™©ì—ì„œ ë°œìƒí• ê¹Œìš”?",
        sound: "q6.mp3",
        options: ["íƒœí’ì´ ë¶ˆ ë•Œ ë‚˜ë¬´ê°€ ë¿Œë¦¬ì§¸ ë½‘íˆëŠ” ì†Œë¦¬", "ì‚°ë¶ˆì´ ë‚¬ì„ ë•Œ ë‚˜ë¬´ê°€ íƒ€ëŠ” ì†Œë¦¬", "ê°•í•œ ë°”ëŒì— ì—¬ëŸ¬ ì”ê°€ì§€ë“¤ì´ ë¶€ë”ªíˆëŠ” ì†Œë¦¬", "ìƒˆë“¤ì´ ë‘¥ì§€ë¥¼ í‹€ ë•Œ ë‚´ëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    },
    {
        q: "ì¼ê³± ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ê°€ì§€ë¡œ ë‚˜ë¬´í†µ ê¸ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ë¥¼ ë“¤ë ¤ì£¼ëŠ” ìƒí™©ì€?",
        sound: "q7.mp3",
        options: ["ë‚˜ë­‡ê°€ì§€ë¡œ ë‹¤ë¥¸ ë‚˜ë¬´í†µì˜ í‘œë©´ì„ ë§ˆì°°ì‹œí‚¤ëŠ” ì†Œë¦¬", "ëŒì„ ë‚˜ë¬´í†µì— ë˜ì§€ëŠ” ì†Œë¦¬", "ê¸ˆì† ê¼¬ì±™ì´ë¡œ ë‚˜ë¬´í†µì„ ëš«ëŠ” ì†Œë¦¬", "ë„ë¼ë¡œ ë‚˜ë¬´ë¥¼ ì°ëŠ” ì†Œë¦¬"],
        answerIndex: 0 
    },
    {
        q: "ì—¬ëŸ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ê°€ì§€ë¡œ ëŒ ê¸ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì‚¬ìš´ë“œì— ê°€ì¥ ê°€ê¹Œìš´ ê²ƒì€?",
        sound: "q8.mp3",
        options: ["í™ë°”ë‹¥ì— ë‚˜ë­‡ê°€ì§€ë¥¼ ëŒ ë•Œ ë‚˜ëŠ” ì†Œë¦¬", "ë‚˜ë¬´í†µì„ ëŒë¡œ ì¹˜ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ì™€ ëŒì´ ë§ˆì°°í•˜ì—¬ ë‚˜ëŠ” 'ì‚­ì‚­' ì†Œë¦¬", "ë‘ ê°œì˜ ëŒë©©ì´ë¥¼ ë¶€ë”ªíˆëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    },
    {
        q: "ì•„í™‰ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ê°€ì§€ë¡œ í’€ì ìŠ¤ì¹˜ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ë¶€ë“œëŸ¬ìš´ ë§ˆì°°ìŒì´ íŠ¹ì§•ì¸ ì†Œë¦¬ëŠ”?",
        sound: "q9.mp3",
        options: ["ë‚˜ë¬´ê°€ ë¶€ëŸ¬ì§€ëŠ” ì†Œë¦¬", "ì”ê°€ì§€ë¡œ í’€ìì„ ê°€ë³ê²Œ í›‘ëŠ” ì†Œë¦¬", "ìƒˆê°€ ë‚ ê°œë¥¼ í¼ë•ì´ëŠ” ì†Œë¦¬", "ë‚˜ë­‡ì ìœ„ë¡œ ë¹„ê°€ ë–¨ì–´ì§€ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ì—´ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ì ë–¨ì–´ì§€ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ê°€ ê°€ì¥ ì˜ ë“¤ë¦¬ëŠ” ë•ŒëŠ”?",
        sound: "q10.mp3",
        options: ["ë°”ëŒì´ ì „í˜€ ì—†ì„ ë•Œ ìì´ ë•…ì— ë‹¿ëŠ” ì†Œë¦¬", "ë¬´ì„±í•œ ìˆ² ì†ì—ì„œ ë‚˜ë¬´ê°€ í”ë“¤ë¦´ ë•Œ", "ë‹¨í’ìì´ ë•…ë°”ë‹¥ì— íŠ€ì–´ ì˜¤ë¥´ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ì— ë¬¼ì„ ì£¼ëŠ” ì†Œë¦¬"],
        answerIndex: 0 
    },
    {
        q: "ì—´í•œ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ì ë¶€ìŠ¤ë¥´ëŠ” ì†Œë¦¬ ë§Œì§€ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ê±´ì¡°í•œ ë‚˜ë­‡ìì„ ë§Œì§ˆ ë•Œ ë‚˜ëŠ” ì†Œë¦¬ëŠ”?",
        sound: "q11.mp3",
        options: ["ì¶•ì¶•í•œ í™ì„ ë§Œì§€ëŠ” ì†Œë¦¬", "ë§ˆë¥¸ ë‚˜ë­‡ìì„ ì†ìœ¼ë¡œ êµ¬ê¸°ê±°ë‚˜ ë¹„ë¹„ëŠ” ì†Œë¦¬", "ì¢…ì´ë¥¼ ì°¢ëŠ” ì†Œë¦¬", "ë¹„ ì˜¤ëŠ” ë‚  ìš°ì‚°ì„ í¼ì¹˜ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ì—´ë‘ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚˜ë­‡ì ì†ìœ¼ë¡œ ìŠ¤ì¹˜ëŠ” ë§Œì§€ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ëŠ” ë¬´ì—‡ì„ ë¬˜ì‚¬í• ê¹Œìš”?",
        sound: "q12.mp3",
        options: ["ìˆ² ì†ì„ ë›°ì–´ë‹¤ë‹ˆëŠ” ì†Œë¦¬", "ì†ìœ¼ë¡œ ìì‚¬ê·€ë“¤ì„ ì“¸ì–´ë‚´ë¦´ ë•Œ ë‚˜ëŠ” 'ì‚¬ì‚­' ì†Œë¦¬", "ë°”ìœ„ê°€ êµ´ëŸ¬ê°€ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ì— ê¸°ëŒ€ì–´ ì‰¬ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ì—´ì„¸ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë‚™ì—½ ë°ŸëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ê°€ ê°€ì¥ ì˜ ë‚˜ëŠ” ì¡°ê±´ì€?",
        sound: "q13.mp3",
        options: ["í™ë°”ë‹¥ì„ ê±·ëŠ” ì†Œë¦¬", "ì –ì€ ì•„ìŠ¤íŒ”íŠ¸ ìœ„ë¥¼ ê±·ëŠ” ì†Œë¦¬", "ê±´ì¡°í•œ ë‚™ì—½ ìœ„ë¥¼ ê±¸ì„ ë•Œ ë‚˜ëŠ” 'ë°”ìŠ¤ë½' ì†Œë¦¬", "ëŒê³„ë‹¨ì„ ì˜¤ë¥´ëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    },
    {
        q: "ì—´ë„¤ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ëŒë¼ë¦¬ ë¶€ë”ªíˆëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ëŠ”?",
        sound: "q14.mp3",
        options: ["ë¶€ë“œëŸ¬ìš´ ëª¨ë˜ì•Œì´ êµ´ëŸ¬ê°€ëŠ” ì†Œë¦¬", "í™ ì†ì˜ ëŒì„ íŒŒë‚´ëŠ” ì†Œë¦¬", "ë‘ ê°œì˜ ë‹¨ë‹¨í•œ ëŒë©©ì´ê°€ ì¶©ëŒí•˜ëŠ” ì†Œë¦¬", "ì‡ ì™€ ëŒì´ ë§ˆì°°í•˜ëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    },
    {
        q: "ì—´ë‹¤ì„¯ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë§ˆë¥¸ ë‚˜ë­‡ììœ¼ë¡œ ëŒì„ ê¸ê³  ì¹˜ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì‚¬ìš´ë“œë¥¼ ë“¤ë ¤ì£¼ëŠ” í–‰ìœ„ëŠ”?",
        sound: "q15.mp3",
        options: ["ë°”ìœ„ë¥¼ ê¹¨ëŠ” ì†Œë¦¬", "ëŒë©©ì´ë¡œ ëŒë©©ì´ë¥¼ ì¹˜ëŠ” ì†Œë¦¬", "ëŒ í‘œë©´ì„ ë§ˆë¥¸ ë‚˜ë­‡ììœ¼ë¡œ ë¬¸ì§€ë¥´ëŠ” ì†Œë¦¬", "ë‚˜ë­‡ìì„ ëŒ ìœ„ì— ì˜¬ë ¤ë†“ëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    },
    {
        q: "ì—´ì—¬ì„¯ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë¬¼ íë¥´ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ëŠ” ì£¼ë¡œ ì–´ë–¤ ì¥ì†Œì—ì„œ ë“¤ë¦´ê¹Œìš”?",
        sound: "q16.mp3",
        options: ["ë§ˆë¥¸ ë•…", "í­í¬, ì‹œëƒ‡ê°€, ìˆ˜ë„ê¼­ì§€ ë“±", "ì¡°ìš©í•œ ë°© ì•ˆ", "ë°”ëŒì´ ë¶€ëŠ” ë“¤íŒ"],
        answerIndex: 1 
    },
    {
        q: "ì—´ì¼ê³± ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë°”ëŒì— ë‚˜ë­‡ìì—ì„œ ë–¨ì–´ì§€ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ê°€ ì „ë‹¬í•˜ëŠ” ëŠë‚Œì€?",
        sound: "q17.mp3",
        options: ["ë‚˜ë­‡ê°€ì§€ê°€ êº¾ì´ëŠ” ê°•í•œ ì†Œë¦¬", "ë°”ëŒ ë•Œë¬¸ì— ìì´ ë‚˜ë¬´ì—ì„œ ë¶„ë¦¬ë˜ì–´ ë–¨ì–´ì§€ëŠ” ì†Œë¦¬", "ë•…ì— ë–¨ì–´ì§„ ìì„ ì£¼ì›Œ ëª¨ìœ¼ëŠ” ì†Œë¦¬", "ë‚˜ë¬´ì— ë§¤ë‹¬ë¦° ì—´ë§¤ê°€ ë–¨ì–´ì§€ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ì—´ì—¬ëŸ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ë°”ëŒì´ ë‚˜ë­‡ì ìŠ¤ì¹˜ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ì˜ íŠ¹ì§•ì€?",
        sound: "q18.mp3",
        options: ["ì”ì”í•œ ë°”ëŒì— ìë“¤ì´ ë§ˆì°°í•˜ë©° ë‚˜ëŠ” 'ì‰¬ìµ' ì†Œë¦¬", "ë‚˜ë­‡ê°€ì§€ê°€ ë¶€ëŸ¬ì§€ëŠ” ì†Œë¦¬", "ì²œë‘¥ë²ˆê°œê°€ ì¹˜ëŠ” ì†Œë¦¬", "ìƒˆê°€ ë¹ ë¥´ê²Œ ë‚ ì•„ê°€ëŠ” ì†Œë¦¬"],
        answerIndex: 0 
    },
    {
        q: "ì—´ì•„í™‰ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ì‹œëƒ‡ë¬¼' ì†Œë¦¬ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ëŠ”?",
        sound: "q19.mp3",
        options: ["ë°”ë‹·ë¬¼ì´ ì² ì©ì´ëŠ” ì†Œë¦¬", "íë¦„ì´ ë¹ ë¥´ì§€ ì•Šê³  ì–•ì€ ë¬¼ì´ íë¥´ëŠ” ì†Œë¦¬", "íŒŒì´í”„ê°€ í„°ì§€ëŠ” ì†Œë¦¬", "ë¹„ê°€ ì§€ë¶•ì— ë–¨ì–´ì§€ëŠ” ì†Œë¦¬"],
        answerIndex: 1 
    },
    {
        q: "ìŠ¤ë¬´ ë²ˆì§¸ ì‚¬ìš´ë“œëŠ” 'ìê°ˆ ê¸¸ ê±·ëŠ” ì†Œë¦¬'ì…ë‹ˆë‹¤. ì´ ì†Œë¦¬ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” ìƒí™©ì€?",
        sound: "q20.mp3",
        options: ["í‘¹ì‹ í•œ ëª¨ë˜ì‚¬ì¥ ìœ„ë¥¼ ê±·ëŠ” ì†Œë¦¬", "ì”ë””ë°­ ìœ„ë¥¼ ê±·ëŠ” ì†Œë¦¬", "ë‹¨ë‹¨í•œ ìê°ˆì´ ê¹”ë¦° ê¸¸ì„ ë°œë¡œ ë°Ÿì„ ë•Œ ë‚˜ëŠ” ì†Œë¦¬", "ëˆˆ ìœ„ë¥¼ ê±·ëŠ” ì†Œë¦¬"],
        answerIndex: 2 
    }
];

// í˜„ì¬ í€´ì¦ˆ ìƒíƒœ
let currentQuizIndex = 0;
let score = 0;
let selectedOptionIndex = null;

function initQuizPage() {
    const quizContent = document.getElementById('quiz-content');
    if (!quizContent) return; // í˜ì´ì§€ê°€ quiz.htmlì´ ì•„ë‹ˆë©´ ì¢…ë£Œ

    // quiz.htmlì—ì„œë§Œ ì‹¤í–‰ë  ë•Œ í€´ì¦ˆ ì‹œì‘ ì‹œê°„ ê¸°ë¡
    if (!localStorage.getItem(LS_START_TIME)) {
        localStorage.setItem(LS_START_TIME, Date.now());
    }

    loadQuiz(currentQuizIndex);

    // ì‚¬ìš´ë“œ ì¬ìƒ ë²„íŠ¼ ì´ë²¤íŠ¸
    const soundButton = document.getElementById('sound-button');
    if (soundButton) {
        soundButton.onclick = playCurrentSound;
    }
    
    // ì„ íƒ ì™„ë£Œ ë²„íŠ¼ ì´ë²¤íŠ¸
    const completeButton = document.getElementById('complete-selection-button');
    if (completeButton) {
        completeButton.onclick = handleSelectionComplete;
    }
}

// -------------------- í€´ì¦ˆ ë¡œë“œ ë° UI ì—…ë°ì´íŠ¸ --------------------

function loadQuiz(index) {
    // ğŸš¨ [ìˆ˜ì •] í€´ì¦ˆê°€ ë¡œë“œë  ë•Œ ì´ì „ ì˜¤ë””ì˜¤ë¥¼ ì •ì§€ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.
    if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
    }
    
    // í€´ì¦ˆ ì™„ë£Œ ì¡°ê±´ ê²€ì‚¬
    if (index >= QUIZ_TOTAL_COUNT) {
        // 1. í€´ì¦ˆê°€ ëª¨ë‘ ëë‚¬ì„ ê²½ìš°
        
        // ìµœì¢… ì ìˆ˜ë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•©ë‹ˆë‹¤. (userScore í†µì¼)
        localStorage.setItem('userScore', score); 

        // 2. í€´ì¦ˆ ì¢…ë£Œ í›„, 2ë²ˆ ìœ íŠœë¸Œ ì˜ìƒ(YOUTUBE_VIDEO_ID_2)ì„ ì¬ìƒí•˜ëŠ” í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.
        //    ì˜ìƒ ì¬ìƒ í›„ 3ì´ˆ ë’¤ì— 'outro.html' (ê²°ê³¼ í˜ì´ì§€)ë¡œ ë„˜ì–´ê°€ë„ë¡ ê²½ë¡œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
        window.location.href = `result_video.html?video=result&nextPage=outro.html`;
return; // í•¨ìˆ˜ ì¢…ë£Œ
    }
    
    const currentQuiz = quizData[index];
    currentQuizIndex = index;
    selectedOptionIndex = null;

    // ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
    const statusElement = document.getElementById('quiz-status');
    if (statusElement) {
        statusElement.textContent = `ë¬¸ì œ ${index + 1} / ${QUIZ_TOTAL_COUNT}`;
    }
    
    document.getElementById('question-text').textContent = currentQuiz.q;

    // ë³´ê¸° ë²„íŠ¼ ì—…ë°ì´íŠ¸
    const optionsContainer = document.getElementById('options-container');
    optionsContainer.innerHTML = '';
    currentQuiz.options.forEach((option, i) => {
        const button = document.createElement('button');
        button.className = 'option-btn';
        button.textContent = option;
        button.onclick = () => handleOptionSelection(button, i);
        optionsContainer.appendChild(button);
    });

    // ì„ íƒ ì™„ë£Œ ë²„íŠ¼ ë¹„í™œì„±í™”
    const completeButton = document.getElementById('complete-selection-button');
    if (completeButton) {
        completeButton.disabled = true;
    }
    
    // í€´ì¦ˆ ë¡œë“œ ì‹œ ì‚¬ìš´ë“œ ìë™ ì¬ìƒ
    playCurrentSound();
}

// -------------------- ì´ë²¤íŠ¸ ì²˜ë¦¬ --------------------

// js/quiz.js
function playCurrentSound() {
    // 1. ì´ì „ ì˜¤ë””ì˜¤ê°€ ìˆë‹¤ë©´ ì •ì§€
    if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
    }
    
    // 2. ìƒˆ ì˜¤ë””ì˜¤ ê°ì²´ ìƒì„±
    const soundPath = `/quiz-project/assets/sounds/${quizData[currentQuizIndex].sound}`;
    const audio = new Audio(soundPath);
    
    // 3. ìƒˆ ì˜¤ë””ì˜¤ ê°ì²´ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
    currentAudio = audio;

    // 4. ì¬ìƒ ì‹œë„
    audio.play().catch(e => console.error("Sound play failed:", e));
}

function handleOptionSelection(selectedButton, index) {
    // ëª¨ë“  ë²„íŠ¼ì˜ 'selected' í´ë˜ìŠ¤ ì œê±°
    document.querySelectorAll('.option-btn').forEach(btn => {
        btn.classList.remove('selected');
    });

    // ì„ íƒëœ ë²„íŠ¼ì— 'selected' í´ë˜ìŠ¤ ì¶”ê°€
    selectedButton.classList.add('selected');
    selectedOptionIndex = index;

    // ì„ íƒ ì™„ë£Œ ë²„íŠ¼ í™œì„±í™”
    const completeButton = document.getElementById('complete-selection-button');
    if (completeButton) {
        completeButton.disabled = false;
    }
}

function handleSelectionComplete() {
    if (selectedOptionIndex === null) {
        alert('ë³´ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
    }

    // 1. ì ìˆ˜ ê³„ì‚°
    const currentQuiz = quizData[currentQuizIndex];
    if (selectedOptionIndex === currentQuiz.answerIndex) {
        score++;
    }

    // 2. ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
    loadQuiz(currentQuizIndex + 1);
}

document.addEventListener('DOMContentLoaded', () => {
    // quiz.htmlì—ì„œë§Œ ì‹¤í–‰
    if (window.location.pathname.split('/').pop() === 'quiz.html') {
        
        // ì´ë¦„ì´ ì—†ìœ¼ë©´ ì¸íŠ¸ë¡œë¡œ ì´ë™ (ê°•ì œì„± ë¶€ì—¬)
        if (!localStorage.getItem(LS_USER_NAME)) {
            alert('ì´ë¦„ ì •ë³´ê°€ ì—†ì–´ ì¸íŠ¸ë¡œ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
            window.location.href = 'index.html';
            return;
        }
        
        initQuizPage();
    }
});




